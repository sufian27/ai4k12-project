{% extends "base.html" %}

{% block content %}
<div class="row">
	<div class="col-md-8 col-xs-8 col-sm-8 col-lg-8">
		<div class="row">
			<div class="col">
				<div class="compare_canvas" style="height: 100px; width: 100px; background-color: #d5f4e6; z-index: 0; position: relative;" ondragover = 'allowDrop(event)' ondrop = 'dropChild(event)' ></div>
				<div class="compare_index"></div>				
			</div>
		</div>
	</div>
	<div id="face_browser" class="col-md-4 col-xs-4 col-sm-4 col-lg-4" style="height: 420px; overflow: scroll;"></div>
</div>
{% endblock %}

{% block script %}
<script>
	// alert("inner script");
	function readpara (para) {
		return para;
	}
	var example_id = readpara( {{ example | safe }} );
	var user_id = readpara( {{ g.user.id | safe }} );
	var getLocalData = localStorage.getItem('localDataset');
	var json_dataset = JSON.parse(getLocalData);
	getLocalData = localStorage.getItem('mappingRule');
	var json_mapping = JSON.parse(getLocalData);
	var variables = Object.keys(json_dataset[0]);

	function allowDrop(ev) {
        ev.preventDefault();
    }
    function drag(ev) {
        ev.dataTransfer.setData('Img', ev.target.id);
    }
    function dropChild(ev) {
        ev.preventDefault();
        var data = ev.dataTransfer.getData('img');
        var data_element = document.getElementById(data);
        data_element.width = "100";
        if (ev.target.className == 'compare_canvas') {
        	var x = ev.target.childElementCount;
        	data_element.style.zIndex = x.toString();
        	ev.target.appendChild(data_element);
        } else {
        	var x = ev.target.parentNode.childElementCount;
        	data_element.style.zIndex = x.toString();
        	ev.target.after(data_element);
        }
        $(".compare_canvas img").css('position', 'absolute');
        $(".compare_canvas img").css('top', 0);
        $(".compare_canvas img").css('left', 0);
        $(".compare_canvas").children("img").css('opacity', 1/(x+1));
    }

</script>
<script src="{{ url_for('static', filename = 'js/face_browser.js') }}"></script>
{% endblock %}